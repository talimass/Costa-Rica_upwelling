upper <- Q3 + 1.5 * IQR_value
fvfm_no_outlier <- fire_clean %>%
filter(fv_fm >= lower & fv_fm <= upper)
cat("Rows before filtering:", nrow(fire_clean), "\n")
cat("Rows after filtering :", nrow(fvfm_no_outlier), "\n")
# ===============================
# Plot: Both sites on same panel
# ===============================
fvfm_plot <- ggplot(fvfm_no_outlier,
aes(x = factor(Temp),
y = fv_fm,
fill = Site)) +
geom_boxplot(alpha = 0.6,
outlier.shape = NA,
position = position_dodge(width = 0.8)) +
geom_jitter(aes(color = Site),
position = position_jitterdodge(
jitter.width = 0.15,
dodge.width = 0.8
),
size = 1.5,
alpha = 0.6) +
theme_classic() +
labs(title = "Quantum Yield of PSII (Fv/Fm)",
x = "Temperature",
y = "Fv/Fm") +
theme(legend.position = "right")
print(fvfm_plot)
# ===============================
# Save plot
# ===============================
output_folder <- "/Users/talimass/Documents/Documents - MacBook Pro/GitHub/Costar-Rica-TPC/Output"
dir.create(output_folder, showWarnings = FALSE)
file_name <- file.path(output_folder, "fvfm_both_sites.png")
ggsave(filename = file_name,
plot = fvfm_plot,
width = 8,
height = 6,
dpi = 300)
cat("Plot saved at:", file_name, "\n")
# ===============================
# Basic cleaning
# ===============================
# Ensure numeric
fire.data$Sigma <- as.numeric(fire.data$Sigma)
fire.data$Temp  <- as.numeric(fire.data$Temp)
# Remove NA only for needed variables
sigma_clean <- fire.data %>%
filter(!is.na(Sigma),
!is.na(Temp),
!is.na(Site))
# ===============================
# Remove outliers (IQR method)
# ===============================
Q1  <- quantile(sigma_clean$Sigma, 0.25)
Q3  <- quantile(sigma_clean$Sigma, 0.75)
IQR_value <- Q3 - Q1
lower <- Q1 - 1.5 * IQR_value
upper <- Q3 + 1.5 * IQR_value
sigma_no_outlier <- sigma_clean %>%
filter(Sigma >= lower & Sigma <= upper)
cat("Rows before filtering:", nrow(sigma_clean), "\n")
cat("Rows after filtering :", nrow(sigma_no_outlier), "\n")
# ===============================
# Plot: Both sites on same panel
# ===============================
sigma_plot <- ggplot(sigma_no_outlier,
aes(x = factor(Temp),
y = Sigma,
fill = Site)) +
geom_boxplot(alpha = 0.6,
outlier.shape = NA,
position = position_dodge(width = 0.8)) +
geom_jitter(aes(color = Site),
position = position_jitterdodge(
jitter.width = 0.15,
dodge.width = 0.8
),
size = 1.5,
alpha = 0.6) +
theme_classic() +
labs(title = "Functional Absorption Cross-Section of PSII (Sigma)",
x = "Temperature",
y = expression(sigma[PSII])) +
theme(legend.position = "right")
print(sigma_plot)
# ===============================
# Save plot
# ===============================
output_folder <- "/Users/talimass/Documents/Documents - MacBook Pro/GitHub/Costar-Rica-TPC/Output"
dir.create(output_folder, showWarnings = FALSE)
file_name <- file.path(output_folder, "Sigma_both_sites.png")
ggsave(filename = file_name,
plot = sigma_plot,
width = 8,
height = 6,
dpi = 300)
cat("Plot saved at:", file_name, "\n")
# ===============================
# Basic cleaning
# ===============================
# Ensure numeric
fire.data$Pmax.e.s <- as.numeric(fire.data$Pmax.e.s)
fire.data$Temp     <- as.numeric(fire.data$Temp)
# Remove NA only for needed variables
pmax_clean <- fire.data %>%
filter(!is.na(Pmax.e.s),
!is.na(Temp),
!is.na(Site))
# ===============================
# Remove outliers (IQR method)
# ===============================
Q1  <- quantile(pmax_clean$Pmax.e.s, 0.25)
Q3  <- quantile(pmax_clean$Pmax.e.s, 0.75)
IQR_value <- Q3 - Q1
lower <- Q1 - 1.5 * IQR_value
upper <- Q3 + 1.5 * IQR_value
pmax_no_outlier <- pmax_clean %>%
filter(Pmax.e.s >= lower & Pmax.e.s <= upper)
cat("Rows before filtering:", nrow(pmax_clean), "\n")
cat("Rows after filtering :", nrow(pmax_no_outlier), "\n")
# ===============================
# Plot: Both sites on same panel
# ===============================
pmax_plot <- ggplot(pmax_no_outlier,
aes(x = factor(Temp),
y = Pmax.e.s,
fill = Site)) +
geom_boxplot(alpha = 0.6,
outlier.shape = NA,
position = position_dodge(width = 0.8)) +
geom_jitter(aes(color = Site),
position = position_jitterdodge(
jitter.width = 0.15,
dodge.width = 0.8
),
size = 1.5,
alpha = 0.6) +
theme_classic() +
labs(title = "Maximum Electron Transport Rate (Pmax)",
x = "Temperature",
y = expression(P[max]~"(electrons s"^{-1}~"PSII"^{-1}*")")) +
theme(legend.position = "right")
print(pmax_plot)
# ===============================
# Save plot
# ===============================
output_folder <- "/Users/talimass/Documents/Documents - MacBook Pro/GitHub/Costar-Rica-TPC/Output"
dir.create(output_folder, showWarnings = FALSE)
file_name <- file.path(output_folder, "Pmax_both_sites.png")
ggsave(filename = file_name,
plot = pmax_plot,
width = 8,
height = 6,
dpi = 300)
cat("Plot saved at:", file_name, "\n")
# ===============================
# Basic cleaning
# ===============================
# Ensure numeric
fire.data$p   <- as.numeric(fire.data$p)
fire.data$Temp <- as.numeric(fire.data$Temp)
# Remove NA only for needed variables
p_clean <- fire.data %>%
filter(!is.na(p),
!is.na(Temp),
!is.na(Site))
# ===============================
# Remove outliers (IQR method)
# ===============================
Q1  <- quantile(p_clean$p, 0.25)
Q3  <- quantile(p_clean$p, 0.75)
IQR_value <- Q3 - Q1
lower <- Q1 - 1.5 * IQR_value
upper <- Q3 + 1.5 * IQR_value
p_no_outlier <- p_clean %>%
filter(p >= lower & p <= upper)
cat("Rows before filtering:", nrow(p_clean), "\n")
cat("Rows after filtering :", nrow(p_no_outlier), "\n")
# ===============================
# Plot: Both sites on same panel
# ===============================
p_plot <- ggplot(p_no_outlier,
aes(x = factor(Temp),
y = p,
fill = Site)) +
geom_boxplot(alpha = 0.6,
outlier.shape = NA,
position = position_dodge(width = 0.8)) +
geom_jitter(aes(color = Site),
position = position_jitterdodge(
jitter.width = 0.15,
dodge.width = 0.8
),
size = 1.5,
alpha = 0.6) +
theme_classic() +
labs(title = "Connectivity (p) across Temperature",
x = "Temperature",
y = "p (–)") +
theme(legend.position = "right")
print(p_plot)
# ===============================
# Save plot
# ===============================
output_folder <- "/Users/talimass/Documents/Documents - MacBook Pro/GitHub/Costar-Rica-TPC/Output"
dir.create(output_folder, showWarnings = FALSE)
file_name <- file.path(output_folder, "p_both_sites.png")
ggsave(filename = file_name,
plot = p_plot,
width = 8,
height = 6,
dpi = 300)
cat("Plot saved at:", file_name, "\n")
# ===============================
# Basic cleaning
# ===============================
# Ensure numeric
fire.data$Fm   <- as.numeric(fire.data$Fm)
fire.data$Temp <- as.numeric(fire.data$Temp)
# Remove NA only for needed variables
Fm_clean <- fire.data %>%
filter(!is.na(Fm),
!is.na(Temp),
!is.na(Site))
# ===============================
# Remove outliers (IQR method)
# ===============================
Q1  <- quantile(Fm_clean$Fm, 0.25)
Q3  <- quantile(Fm_clean$Fm, 0.75)
IQR_value <- Q3 - Q1
lower <- Q1 - 1.5 * IQR_value
upper <- Q3 + 1.5 * IQR_value
Fm_no_outlier <- Fm_clean %>%
filter(Fm >= lower & Fm <= upper)
cat("Rows before filtering:", nrow(Fm_clean), "\n")
cat("Rows after filtering :", nrow(Fm_no_outlier), "\n")
# ===============================
# Plot: Both sites on same panel
# ===============================
Fm_plot <- ggplot(Fm_no_outlier,
aes(x = factor(Temp),
y = Fm,
fill = Site)) +
geom_boxplot(alpha = 0.6,
outlier.shape = NA,
position = position_dodge(width = 0.8)) +
geom_jitter(aes(color = Site),
position = position_jitterdodge(
jitter.width = 0.15,
dodge.width = 0.8
),
size = 1.5,
alpha = 0.6) +
theme_classic() +
labs(title = "Maximum Fluorescence (Fm) across Temperature",
x = "Temperature",
y = "Fm") +
theme(legend.position = "right")
print(Fm_plot)
# ===============================
# Save plot
# ===============================
output_folder <- "/Users/talimass/Documents/Documents - MacBook Pro/GitHub/Costar-Rica-TPC/Output"
dir.create(output_folder, showWarnings = FALSE)
file_name <- file.path(output_folder, "Fm_both_sites.png")
ggsave(filename = file_name,
plot = Fm_plot,
width = 8,
height = 6,
dpi = 300)
cat("Plot saved at:", file_name, "\n")
# ==========================================
# Universal plotting function
# ==========================================
plot_psii_variable <- function(data, variable, y_label, file_name) {
# Ensure numeric
data[[variable]] <- as.numeric(data[[variable]])
data$Temp <- as.numeric(data$Temp)
# Remove NA safely
data_clean <- data %>%
filter(!is.na(.data[[variable]]),
!is.na(Temp),
!is.na(Site))
# Remove outliers using IQR
Q1 <- quantile(data_clean[[variable]], 0.25)
Q3 <- quantile(data_clean[[variable]], 0.75)
IQR_value <- Q3 - Q1
lower <- Q1 - 1.5 * IQR_value
upper <- Q3 + 1.5 * IQR_value
data_filtered <- data_clean %>%
filter(.data[[variable]] >= lower &
.data[[variable]] <= upper)
cat("\n---------------------------------\n")
cat("Variable:", variable, "\n")
cat("Rows before filtering:", nrow(data_clean), "\n")
cat("Rows after filtering :", nrow(data_filtered), "\n")
# Create plot
p <- ggplot(data_filtered,
aes(x = factor(Temp),
y = .data[[variable]],
fill = Site)) +
geom_boxplot(alpha = 0.6,
outlier.shape = NA,
position = position_dodge(width = 0.8)) +
geom_jitter(aes(color = Site),
position = position_jitterdodge(
jitter.width = 0.15,
dodge.width = 0.8
),
size = 1.5,
alpha = 0.6) +
theme_classic() +
labs(title = paste(variable, "across Temperature"),
x = "Temperature",
y = y_label) +
theme(legend.position = "right")
print(p)
# Save plot
output_folder <- "/Users/talimass/Documents/Documents - MacBook Pro/GitHub/Costar-Rica-TPC/Output"
dir.create(output_folder, showWarnings = FALSE)
ggsave(
filename = file.path(output_folder, file_name),
plot = p,
width = 8,
height = 6,
dpi = 300
)
}
# ==========================================
# Generate All Plots
# ==========================================
plot_psii_variable(fire.data, "fv_fm", "Fv/Fm", "fvfm_both_sites.png")
plot_psii_variable(fire.data, "Sigma",
expression(sigma[PSII]),
"Sigma_both_sites.png")
plot_psii_variable(fire.data, "Pmax.e.s",
expression(P[max]~"(electrons s"^{-1}~"PSII"^{-1}*")"),
"Pmax_both_sites.png")
plot_psii_variable(fire.data, "p",
"p (–)",
"p_both_sites.png")
plot_psii_variable(fire.data, "Fm",
"Fm",
"Fm_both_sites.png")
plot_psii_variable(fire.data, "TauAv1",
expression(tau[Av1]),
"TauAv1_both_sites.png")
# ==========================================
# Universal plotting function (Facet Species)
# ==========================================
plot_psii_species <- function(data, variable, y_label, file_name) {
# Ensure numeric
data[[variable]] <- as.numeric(data[[variable]])
data$Temp <- as.numeric(data$Temp)
# Remove NA safely
data_clean <- data %>%
filter(!is.na(.data[[variable]]),
!is.na(Temp),
!is.na(Site),
!is.na(Species))
# Remove outliers (IQR method)
Q1 <- quantile(data_clean[[variable]], 0.25)
Q3 <- quantile(data_clean[[variable]], 0.75)
IQR_value <- Q3 - Q1
lower <- Q1 - 1.5 * IQR_value
upper <- Q3 + 1.5 * IQR_value
data_filtered <- data_clean %>%
filter(.data[[variable]] >= lower &
.data[[variable]] <= upper)
cat("\n---------------------------------\n")
cat("Variable:", variable, "\n")
cat("Rows before filtering:", nrow(data_clean), "\n")
cat("Rows after filtering :", nrow(data_filtered), "\n")
# Plot
p <- ggplot(data_filtered,
aes(x = factor(Temp),
y = .data[[variable]],
fill = Site)) +
geom_boxplot(alpha = 0.6,
outlier.shape = NA,
position = position_dodge(width = 0.8)) +
geom_jitter(aes(color = Site),
position = position_jitterdodge(
jitter.width = 0.15,
dodge.width = 0.8
),
size = 1.5,
alpha = 0.6) +
facet_wrap(~ Species) +
theme_classic() +
labs(title = paste(variable, "across Temperature by Species"),
x = "Temperature",
y = y_label) +
theme(legend.position = "right")
print(p)
# Save
output_folder <- "/Users/talimass/Documents/Documents - MacBook Pro/GitHub/Costar-Rica-TPC/Output"
dir.create(output_folder, showWarnings = FALSE)
ggsave(
filename = file.path(output_folder, file_name),
plot = p,
width = 10,
height = 6,
dpi = 300
)
}
# ==========================================
# Generate All Plots
# ==========================================
plot_psii_species(fire.data, "fv_fm",
"Fv/Fm",
"fvfm_species.png")
plot_psii_species(fire.data, "Sigma",
expression(sigma[PSII]),
"Sigma_species.png")
plot_psii_species(fire.data, "Pmax.e.s",
expression(P[max]~"(electrons s"^{-1}~"PSII"^{-1}*")"),
"Pmax_species.png")
plot_psii_species(fire.data, "p",
"p (–)",
"p_species.png")
plot_psii_species(fire.data, "Fm",
"Fm",
"Fm_species.png")
plot_psii_species(fire.data, "TauAv1",
expression(tau[Av1]),
"TauAv1_species.png")
fire.data <- read.csv(
"/Users/talimass/Documents/Documents - MacBook Pro/GitHub/Costar-Rica-TPC/FIRE_all_sites_anotated.xls.csv",
stringsAsFactors = FALSE
)
# ==========================================
# Universal plotting function (Facet Species)
# ==========================================
plot_psii_species <- function(data, variable, y_label, file_name) {
# Ensure numeric
data[[variable]] <- as.numeric(data[[variable]])
data$Temp <- as.numeric(data$Temp)
# Remove NA safely
data_clean <- data %>%
filter(!is.na(.data[[variable]]),
!is.na(Temp),
!is.na(Site),
!is.na(Species))
# Remove outliers (IQR method)
Q1 <- quantile(data_clean[[variable]], 0.25)
Q3 <- quantile(data_clean[[variable]], 0.75)
IQR_value <- Q3 - Q1
lower <- Q1 - 1.5 * IQR_value
upper <- Q3 + 1.5 * IQR_value
data_filtered <- data_clean %>%
filter(.data[[variable]] >= lower &
.data[[variable]] <= upper)
cat("\n---------------------------------\n")
cat("Variable:", variable, "\n")
cat("Rows before filtering:", nrow(data_clean), "\n")
cat("Rows after filtering :", nrow(data_filtered), "\n")
# Plot
p <- ggplot(data_filtered,
aes(x = factor(Temp),
y = .data[[variable]],
fill = Site)) +
geom_boxplot(alpha = 0.6,
outlier.shape = NA,
position = position_dodge(width = 0.8)) +
geom_jitter(aes(color = Site),
position = position_jitterdodge(
jitter.width = 0.15,
dodge.width = 0.8
),
size = 1.5,
alpha = 0.6) +
facet_wrap(~ Species) +
theme_classic() +
labs(title = paste(variable, "across Temperature by Species"),
x = "Temperature",
y = y_label) +
theme(legend.position = "right")
print(p)
# Save
output_folder <- "/Users/talimass/Documents/Documents - MacBook Pro/GitHub/Costar-Rica-TPC/Output"
dir.create(output_folder, showWarnings = FALSE)
ggsave(
filename = file.path(output_folder, file_name),
plot = p,
width = 10,
height = 6,
dpi = 300
)
}
# ==========================================
# Generate All Plots
# ==========================================
plot_psii_species(fire.data, "fv_fm",
"Fv/Fm",
"fvfm_species.png")
plot_psii_species(fire.data, "Sigma",
expression(sigma[PSII]),
"Sigma_species.png")
plot_psii_species(fire.data, "Pmax.e.s",
expression(P[max]~"(electrons s"^{-1}~"PSII"^{-1}*")"),
"Pmax_species.png")
plot_psii_species(fire.data, "p",
"p (–)",
"p_species.png")
plot_psii_species(fire.data, "Fm",
"Fm",
"Fm_species.png")
plot_psii_species(fire.data, "TauAv1",
expression(tau[Av1]),
"TauAv1_species.png")
